---
// src/layouts/BaseLayout.astro
import NavMenu from '../components/footerMenu.astro';
import Header from '../components/Header.astro';
import VerticalMenu from '../components/VerticalMenu.astro';

import '../styles/global.css';
const pathname = Astro.url.pathname;
const isNavHidden =
  pathname.startsWith('/intro/') || pathname.startsWith('/gete/');
const isIndex = pathname === '/';

const { title = 'RUCKY-PANN', generator = 'Default Generator' } = Astro.props;
---

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="generator" content={generator} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
  </head>

  <body>
    {isIndex ? null : <Header />}

    <div style="display: flex; min-height: 100vh;">
      {isIndex ? null : <VerticalMenu />}
      <main style="flex-grow: 1;">
        <slot />
      </main>
    </div>

    <script>
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
              // 一度だけ動作させるならコメントアウト解除
              // observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.2 },
      );

      document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.scroll-fade').forEach((el) => {
          observer.observe(el);
        });
      });
    </script>

    {
      !isNavHidden && (
        <NavMenu
          label="MAPエリア紹介"
          sub="MAP Area.contents"
          href="/pages/areaMap/"
        />
      )
    }
  </body>
</html>
